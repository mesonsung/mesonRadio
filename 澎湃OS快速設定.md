# 🚀 小米澎湃OS（HyperOS）背景播放快速設定
# Xiaomi HyperOS Background Playback Quick Setup

## 🎯 您的系統：小米澎湃OS（HyperOS）

澎湃OS 是小米 2023 年底推出的全新操作系統，取代了 MIUI。

**好消息**：澎湃OS 的背景限制比 MIUI 略為寬鬆  
**壞消息**：仍需要正確設定才能正常背景播放

---

## ⚡ 5 分鐘快速設定

### 最快方式：

1. **打開設定 App**
2. **搜尋框輸入**：`mesonRadio`
3. **點擊搜尋結果**
4. **完成以下設定** ⬇️

---

## 📋 必須完成的設定（澎湃OS版）

### ✅ 1. 電池使用 → 無限制（最重要！）⭐

```
設定 → 應用 → 應用管理 → mesonRadio
  → 電池使用 → 選擇「無限制」
```

**選項說明**：
- ❌ 智能限制 - 會被殺掉，不要選！
- ✅ **無限制** - 選這個！
- ❌ 省電 - 會被限制，不要選！

---

### ✅ 2. 後台自啟動 → 開啟

```
在 mesonRadio 應用詳情頁
  → 找到「後台自啟動」或「自啟動」
  → 打開開關（綠色）
```

**澎湃OS 特點**：
- 可能顯示為「後台自啟動」
- 或「應用行為控制」
- 必須開啟！

---

### ✅ 3. 後台彈出界面 → 允許

```
在 mesonRadio 應用詳情頁
  → 找到「後台彈出界面」
  → 打開開關（綠色）
```

**作用**：允許前台服務通知顯示

---

### ✅ 4. 通知管理 → 允許

```
在 mesonRadio 應用詳情頁
  → 通知管理
  → 允許通知
  → 確保「背景播放」頻道已啟用
```

**澎湃OS 通知特點**：
- 通知已優化為最低優先級
- 自動摺疊在底部
- 完全靜音

---

### ✅ 5. （可選）鎖屏清理

澎湃OS 可能將此項整合到「電池使用」中。

如果看到「鎖屏清理」選項：
```
在 mesonRadio 應用詳情頁
  → 鎖屏清理
  → 關閉開關（灰色）
```

---

## 🔍 澎湃OS vs MIUI 差異

| 項目 | 澎湃OS (HyperOS) | MIUI |
|------|-----------------|------|
| 設定入口 | 設定 → 應用 | 設定 → 應用設定 |
| 電池優化 | 電池使用 | 省電策略 |
| 自啟動 | 後台自啟動 | 自啟動 |
| 鎖屏清理 | 可能已整合 | 獨立選項 |
| 限制程度 | 略為寬鬆 | 非常嚴格 |
| 界面 | 更現代化 | 傳統風格 |

---

## 🧪 完整測試流程

```bash
# 1. 安裝最新版本（已優化通知）
adb install -r android/app/build/outputs/apk/release/app-release.apk

# 2. 在手機上完成上述設定

# 3. 啟動應用並播放電台

# 4. 監控日誌（可選）
adb logcat | grep -E "前台服務|Foreground|健康檢查|Playing"

# 5. 鎖屏測試
#    - 鎖屏
#    - 等待 10 分鐘
#    - 解鎖檢查
```

### ✅ 成功標誌：

- 🎵 通知欄顯示電台名稱（非常低調）
- 🔒 鎖屏後音樂繼續播放
- ⏱️ 10 分鐘後音樂仍在播放
- 📊 日誌每 30 秒顯示健康檢查

---

## 📱 澎湃OS 特定設定

### 額外推薦設定：

#### 1. 應用行為控制（如果有）

```
設定 → 應用 → 應用管理 → mesonRadio
  → 應用行為控制
  → 設為「無限制」
```

#### 2. 省電模式白名單

```
設定 → 電池與效能 → 省電模式
  → 自訂省電模式
  → 將 mesonRadio 加入白名單
```

#### 3. 通知優先級

```
設定 → 通知與控制中心 → 通知排序方式
  → 選擇「按時間排序」（而非智能排序）
```

---

## 🎯 澎湃OS 檢查清單

在 mesonRadio 應用詳情頁，確認以下項目：

```
mesonRadio 應用詳情（澎湃OS）
├─ ✅ 電池使用：無限制
├─ ✅ 後台自啟動：已開啟（綠色）
├─ ✅ 後台彈出界面：已開啟（綠色）
├─ ✅ 通知管理：已允許
└─ ✅ （可選）鎖屏清理：已關閉（如果有此選項）
```

**所有項目都必須正確設定！**

---

## ❓ 澎湃OS 常見問題

### Q1: 找不到「省電策略」選項？

**A:** 澎湃OS 將其改名為「電池使用」
- 路徑：應用管理 → mesonRadio → 電池使用

### Q2: 找不到「自啟動」選項？

**A:** 澎湃OS 可能顯示為「後台自啟動」
- 也可能在「應用行為控制」中

### Q3: 澎湃OS 的背景限制更寬鬆嗎？

**A:** 比 MIUI 略好，但仍需正確設定
- 不設定仍會被系統殺掉
- 必須完成所有設定才能穩定運行

### Q4: 通知會很打擾嗎？

**A:** 我們已經優化到極致
- PRIORITY_MIN - 最低優先級
- 完全靜音
- 自動摺疊在底部
- 幾乎不會注意到它

---

## 🔧 澎湃OS 診斷命令

```bash
# 檢查系統版本
adb shell getprop ro.mi.os.version.name  # 澎湃OS 版本

# 檢查電池優化
adb shell dumpsys deviceidle whitelist | grep mesonradio

# 檢查應用狀態
adb shell dumpsys package com.meson.mesonradio | grep -E "enabled|permission"

# 查看進程
adb shell ps | grep mesonradio
```

---

## 💡 澎湃OS 專屬提示

### ✅ 推薦做法：

1. **使用搜尋功能**
   - 澎湃OS 的搜尋更智能
   - 直接搜尋「mesonRadio」最快

2. **定期檢查設定**
   - 澎湃OS 更新後可能重置設定
   - 建議每次系統更新後檢查

3. **善用「應用分身」功能**
   - 澎湃OS 的應用分身不會影響背景播放
   - 主應用設定好即可

### ❌ 避免這些操作：

1. **不要開啟「超級省電」**
   - 會強制殺掉所有背景應用

2. **避免使用「智能清理」**
   - 可能會清理 mesonRadio

3. **不要啟用「應用凍結」**
   - 會阻止應用在背景運行

---

## 🆚 如何確認是澎湃OS？

### 方法 1：查看設定界面

澎湃OS 特徵：
- ✅ 更現代化的界面設計
- ✅ 設定入口為「設定 → 應用」
- ✅ 顯示「HyperOS」字樣

MIUI 特徵：
- 傳統界面
- 設定入口為「設定 → 應用設定」
- 顯示「MIUI」字樣

### 方法 2：使用 ADB 命令

```bash
# 查看系統版本
adb shell getprop ro.mi.os.version.name

# 如果顯示 "HyperOS 1.x" → 澎湃OS
# 如果顯示 "MIUI 14" 等 → MIUI
```

---

## 🎉 澎湃OS 的優勢

相比 MIUI，澎湃OS 在背景播放方面：

✅ 設定更簡潔  
✅ 限制略為寬鬆  
✅ 系統優化更好  
✅ 通知管理更智能  
✅ 電池管理更合理  

但仍需完成必要設定！

---

## 📞 需要幫助？

如果完成所有設定後仍有問題：

### 提供以下信息：

```bash
# 1. 系統版本
adb shell getprop ro.mi.os.version.name
adb shell getprop ro.build.version.release

# 2. 運行診斷
./diagnose-background.sh > hyperos-diagnosis.txt

# 3. 收集日誌
adb logcat > hyperos-issue.log
# 播放、鎖屏、等待 5 分鐘後停止
```

---

## 📚 相關文檔

- **`小米MIUI背景播放設定指南.md`** - 完整指南（含 MIUI 和 澎湃OS）
- **`關於背景播放通知.md`** - 為什麼需要通知
- **`背景播放通知優化完成.txt`** - 通知優化說明

---

**更新日期**：2025-10-08  
**版本**：v1.0.5 - 澎湃OS 專版  
**適用於**：小米澎湃OS 1.0/2.0 及之後版本

🎵 **享受在澎湃OS上的完美背景播放體驗！**
