# 測試媒體控制功能指南

## 🚀 快速測試

### 前置準備
1. **重新建置 APK**（已整合新功能）
2. **安裝到手機**
3. **授予必要權限**（通知、後台運行）

### 測試步驟

#### 測試 1：基本鎖屏控制
1. 打開 mesonRadio
2. 播放任意電台
3. 鎖定手機螢幕
4. **預期結果**：
   - ✅ 鎖屏顯示電台名稱
   - ✅ 顯示電台圖標（如果有）
   - ✅ 顯示播放/暫停/停止按鈕
   - ✅ 音訊繼續播放

#### 測試 2：鎖屏播放控制
1. 在鎖屏狀態
2. 點擊暫停按鈕
3. **預期結果**：
   - ✅ 音訊立即暫停
   - ✅ 按鈕變為播放圖標
4. 點擊播放按鈕
5. **預期結果**：
   - ✅ 音訊恢復播放
   - ✅ 按鈕變為暫停圖標

#### 測試 3：通知欄控制
1. 解鎖手機
2. 下拉通知欄
3. **預期結果**：
   - ✅ 看到 mesonRadio 通知
   - ✅ 顯示電台信息
   - ✅ 顯示播放控制按鈕
4. 點擊暫停按鈕
5. **預期結果**：
   - ✅ 音訊暫停
   - ✅ 通知欄更新狀態

#### 測試 4：藍牙耳機控制（如果有）
1. 連接藍牙耳機
2. 播放電台
3. 按下耳機上的播放/暫停按鈕
4. **預期結果**：
   - ✅ 音訊響應耳機控制
   - ✅ 應用狀態同步更新

#### 測試 5：應用切換
1. 播放電台
2. 切換到其他應用
3. **預期結果**：
   - ✅ 音訊繼續播放
   - ✅ 通知欄顯示控制
4. 從其他應用播放音樂/視頻
5. **預期結果**：
   - ✅ mesonRadio 自動暫停
   - ✅ 或降低音量（取決於系統設定）

#### 測試 6：來電測試
1. 播放電台
2. 接聽來電
3. **預期結果**：
   - ✅ 電台自動暫停
   - ✅ 通話清晰無干擾
4. 結束通話
5. **預期結果**：
   - ✅ 電台可以手動恢復播放

## 📊 預期日誌

### 啟動時
```
✅ 音訊模式已配置（後台播放、屏幕關閉播放）
✅ Track Player 已初始化（系統媒體控制）
```

### 播放時
```
🔒 Play lock acquired for station: XXX
✅ Sound instance created successfully
✅ 流媒體播放成功
✅ Keep Awake 已激活（屏幕關閉時繼續播放）
✅ Track Player 媒體會話已更新
📱 通知已顯示: XXX 播放中
```

### 鎖屏控制時
```
⏸️ 遠端暫停事件（通知欄/鎖屏按下暫停）
```
或
```
🎵 遠端播放事件（通知欄/鎖屏按下播放）
```

## ⚠️ 可能的問題

### Track Player 初始化失敗
**日誌**：
```
⚠️ Track Player 初始化失敗（降級到基本通知）
```

**影響**：
- 鎖屏控制可能不顯示
- 藍牙耳機控制可能無效
- 但基本播放功能正常

**解決**：
- 檢查詳細日誌錯誤
- 確認 react-native-track-player 正確安裝
- 重新建置 APK

### 權限不足
**症狀**：
- 通知不顯示
- 鎖屏無控制

**解決**：
1. 設定 → 應用 → mesonRadio
2. 權限 → 允許通知
3. 電池優化 → 不優化
4. 後台運行 → 允許

### 小米/華為/OPPO/VIVO 系統
這些系統可能需要額外設定：

1. **自啟動權限**
   - 設定 → 應用管理 → mesonRadio
   - 自啟動 → 允許

2. **後台限制**
   - 設定 → 省電模式
   - mesonRadio → 無限制

3. **通知優先級**
   - 設定 → 通知管理
   - mesonRadio → 允許所有通知

## 🎯 成功標準

所有測試通過：
- [x] 鎖屏顯示控制
- [x] 鎖屏按鈕可用
- [x] 通知欄控制正常
- [x] 藍牙耳機響應（如果有）
- [x] 應用切換不中斷
- [x] 來電自動暫停
- [x] 日誌無錯誤

## 🐛 調試技巧

### 查看日誌
```bash
# Android
adb logcat | grep -E "Track|mesonRadio"

# 過濾特定日誌
adb logcat | grep "Track Player"
```

### 關鍵日誌標記
- `✅` - 成功操作
- `⚠️` - 警告（功能降級）
- `❌` - 錯誤（需要修復）
- `🎵` - 播放事件
- `⏸️` - 暫停事件
- `⏹️` - 停止事件

## 📝 反饋清單

測試完成後，請記錄：

1. **設備信息**
   - 品牌/型號：
   - Android 版本：
   - 系統 UI：

2. **測試結果**
   - 鎖屏控制：✅/❌
   - 通知欄控制：✅/❌
   - 藍牙控制：✅/❌
   - 應用切換：✅/❌

3. **問題描述**（如果有）
   - 現象：
   - 日誌：
   - 復現步驟：

## 🎉 完成！

如果所有測試通過，恭喜！您的 mesonRadio 現在擁有專業級的媒體控制功能！

---

**提示**：如需要進一步自定義，請參考 `系統媒體控制整合說明.md`

